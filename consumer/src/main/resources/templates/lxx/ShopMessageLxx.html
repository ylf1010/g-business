<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>



    <script src="/js/jquery.min.js"></script>

    <!-- jquery -->

    <script type="text/javascript" src="/js2/easyui1.5/jquery.easyui.min.js"></script>
    <!-- css -->
    <link rel="stylesheet" href="/js2/easyui1.5/themes/icon.css" >
    <!-- 主题 -->
    <link rel="stylesheet" href="/js2/easyui1.5/themes/default/easyui.css" >
    <!-- 方言 -->
    <script type="text/javascript" src="/js2/easyui1.5/locale/easyui-lang-zh_CN.js"></script>
    <!-- 图片  -->
    <script src="/js2/uploadify/jquery.uploadify.js"></script>
    <link rel="stylesheet" href="/js2/uploadify/uploadify.css" >
    <!-- 富文本 -->
    <script src="/js2/kindeditor-4.1.10/kindeditor-all.js"></script>
    <link rel="stylesheet" href="/js2/kindeditor-4.1.10/themes/default/default.css" >


</head>

<body>
<form id="ShopMessage" method="post">
    <div style="height:30px;background: #8c8c8c">
        店铺信息
    </div>
    <p></p>
    店铺名称&nbsp;&nbsp;<input type="text" name="dpname" size="28"  value="请输入店铺名称" onfocus="javascript:if(this.value=='请输入店铺名称')this.value='';"  ><br/>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    未认证  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../lxx/AuthenticationTransfer" >立即认证</font></a><br/>
    <p></p>
    店铺Logo&nbsp;<img src="" id="testimg" width="50px" height="50px">
    <input type="hidden" id="hideImg" name="dplogo" >
    <input type="file" id="uploadify"><br/>
    <p></p>
    联系方式&nbsp;&nbsp;<input type="text" name="dpphone" size="28"  value="请输入客户可查看的联系方式" onfocus="javascript:if(this.value=='请输入客户可查看的联系方式')this.value='';" ><br/>
    <p></p>
    经营地址&nbsp;
    <input type="text" id="sheng" class="easyui-combobox" value="省" name="shengid" />
    -
    <input type="text" id="shi" class="easyui-combobox" value="市" name="shiid"/>
    -
    <input type="text" id="xian" class="easyui-combobox" value="县" name="xianid"/>
    <br/>
    <p></p>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="text" name="dpxxdz" size="28"  value="请输入详细地址" onfocus="javascript:if(this.value=='请输入详细地址')this.value='';"><br/>
    <p></p>
    店铺简介&nbsp;&nbsp;<textarea name="dpdesc" rows="4" cols="40"></textarea><br>

    <p></p>
    <input type="button" onclick="addShop()" value="保存">

</form>
<p></p>
<div style="height: 100px;width: 400px;margin-left: 70px">
    我声明，此页面所填写内容均真实有效，
    特别是经营地址为店铺最新可联系到的地
    址，同时可以作为行政机关和司法机关送
    达法律文件的地址。如果上述地址信息有
    误，愿意承担由此带来的平台处罚（处罚
    细则）、行政监管和司法诉讼风险。
</div>

</body>
<script>

    $(function(){

            initAddProvinceSelect();

    }
    );

    //新增

    function addShop(){
                        $.ajax(
                            {
                            url: '/lxx/addShop',
                            type: 'post',
                            cache:false,
                            data: $("#ShopMessage").serialize(),
                            success: function (data) {

                                alert(11);
                                window.location.href="/lxx/ShopMessage";
                            }, error: function () {
                                alert("新增店铺失败");
                            }
                        }
                        );
    }

    //地区三级
    function initAddProvinceSelect(){
        $("#sheng").combobox({
            url:'/lxx/findArea?id=0',
            textField:'areaname',
            valueField:'id',
            onChange:function(newValue,oldValue){
                $("#shi").combobox({
                    url:'/lxx/findArea?id='+newValue,
                    textField:'areaname',
                    valueField:'id',
                        onChange:function(newValue,oldValue){
                            $("#xian").combobox({
                                    url:'/lxx/findArea?id='+newValue,
                                    textField:'areaname',
                                    valueField:'id'
                                }
                            )
                        }
                }
                )
            }
        }
        )

    }
    //上传插件
    $("#uploadify").uploadify(
        {
        //插件自带  不可忽略的参数
        'swf': '<%=request.getContextPath()%>/js/uploadify/uploadify.swf',
        //前台请求后台的url 不可忽略的参数
        'uploader': '<%=request.getContextPath()%>/music/upload.do',
        //给div的进度条加背景 不可忽略
        'queueID': 'fileQueue',
        //上传文件文件名
        'fileObjName' : 'img',
        //给上传按钮设置文字
        'buttonText': '上传图片',
        //设置文件是否自动上传
        'auto': true,
        //可以同时选择多个文件 默认为true  不可忽略
        'multi': false,
        //上传后队列是否消失
        'removeCompleted': true,
        //允许上传的文件后缀
        'fileExt': '*.jpg;*.gif;*.png',
        //
        'cancelImg': '<%=request.getContextPath()%>/js/uploadify/uploadify-cancel.png',
        //队列消失时间
        'removeTimeout' : 1,
        //上传文件的个数，项目中一共可以上传文件的个数
        'uploadLimit':  -1,
        'fileTypeExts': '*.jpg;*.png',
        //开始执行上传
        'onUploadStart':function(files){
            //$.messager.progress({ title:'提示',msg:'上传中...' });
        },
        //上传失败
        'onUploadError':function(){
            //$.messager.progress('close');
            //$.messager.alert('提示','上传失败');
            alert("上传失败");
        },
        //成功回调函数 file：文件对象。data后台输出数据
        'onUploadSuccess':function(file,data,response){
            //$.messager.progress('close');
            //  alert(data+file.name)
            var imgurl = "http://<%= request.getServerName()%>:<%=request.getServerPort()%><%=request.getContextPath()%>/"+data
            $("#testimg").attr("src",imgurl);
            $('#hideImg').val(imgurl);
        }
    }
    );


</script>
</html>